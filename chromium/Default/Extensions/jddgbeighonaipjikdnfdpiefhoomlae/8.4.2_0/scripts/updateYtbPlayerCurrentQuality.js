try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="428490b8-835e-4031-ab77-c68cd889c2f7",e._sentryDebugIdIdentifier="sentry-dbid-428490b8-835e-4031-ab77-c68cd889c2f7")}catch(e){}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"422387be61e16bad55379760503e4d2049ff5b04"},(()=>{const e="hd1080",n={1080:"hd1080",720:"hd720",480:"large",360:"medium",240:"small",144:"tiny"},l=["hd1080","hd720","large","medium","small","tiny"];console.warn("[Ytb Enforcer] Quality order",l);const t={chosenQuality:null,enforceIntervalId:null,playerRef:null};function r(r){if(!r||r.source!==window||!r.data||"ytb-quality-script"!==r.data.source)return;const a=function(){const e=function(){var e;const n=null===(e=document)||void 0===e?void 0:e.getElementById("movie_player");return n&&"function"==typeof n.getAvailableQualityLevels?n:null}();return console.warn("[Ytb Enforcer] Updating player"),e?(t.playerRef!==e&&(t.playerRef=e,console.warn("[Ytb Enforcer] Player found or replaced"),null===(l=t.playerRef)||void 0===l||null===(n=l.addEventListener)||void 0===n||n.call(l,"onPlaybackQualityChange",o)),t.playerRef):null;var n,l}();if(a){if("SET_QUALITY"===r.data.type){var i;const r=(null===(i=a.getAvailableQualityLevels)||void 0===i?void 0:i.call(a))||[],c=a.getPlaybackQuality(),u=function(e){try{var l,t,r;const a=null===(l=localStorage)||void 0===l?void 0:l.getItem("yt-player-quality");if(!a)return null;const i=null===(t=JSON.parse(a))||void 0===t?void 0:t.data;if("string"!=typeof i)return null;const d=null===(r=JSON.parse(i))||void 0===r?void 0:r.quality;var o;const c=null!==(o=n[d])&&void 0!==o?o:d;return e.includes(c)?c:null}catch(e){return console.warn("Error parsing storage quality data",e),null}}(r),f=(d=u)?l.indexOf(d):-1,s=function(n){const t=n.filter(e=>!e.startsWith("auto")).filter(n=>{const t=l.indexOf(n);return-1!==t&&t<=l.indexOf(e)}),r=l.find(e=>t.includes(e));return null!=r?r:null}(r),y=u&&-1!==f?u:s;!y||y===c&&t.enforceIntervalId||function(e){var n,l,r,a,i;t.chosenQuality=e,null===(l=t.playerRef)||void 0===l||null===(n=l.setPlaybackQuality)||void 0===n||n.call(l,e),null===(a=t.playerRef)||void 0===a||null===(r=a.setPlaybackQualityRange)||void 0===r||r.call(a,e),null===t.enforceIntervalId&&(t.enforceIntervalId=null===(i=window)||void 0===i?void 0:i.setInterval(o,6e4),console.warn("[Ytb Enforcer] Started quality enforcement"))}(y)}var d;"STOP_RESTRICT_QUALITY"===r.data.type&&(function(){const{enforceIntervalId:e}=t;null!==e&&(clearInterval(e),t.enforceIntervalId=null,console.warn("[Ytb Enforcer] Stopped quality enforcement"))}(),t.chosenQuality=null)}}function o(){try{console.warn("[Ytb Enforcer] Enforcing quality",t);const{playerRef:o,chosenQuality:a}=t;if(!o||!a)return;const i=o.getPlaybackQuality()||e;var n,r;-1===l.indexOf(i)&&(null===(n=o.setPlaybackQuality)||void 0===n||n.call(o,a),null===(r=o.setPlaybackQualityRange)||void 0===r||r.call(o,a),console.warn(`[Ytb Enforcer] Reverted quality from ${i} to ${a}`))}catch(e){console.error("[Ytb Enforcer] Error enforcing quality",e)}}if(window)try{window.removeEventListener("message",r),window.addEventListener("message",r)}catch(e){console.error("[Ytb Enforcer] Error adding/removing listener to message",e)}})();
//# sourceMappingURL=updateYtbPlayerCurrentQuality.js.map