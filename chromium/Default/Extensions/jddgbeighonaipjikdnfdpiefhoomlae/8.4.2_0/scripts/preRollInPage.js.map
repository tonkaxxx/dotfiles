{"version":3,"file":"scripts/preRollInPage.js","mappings":"skBA+BA,MAAMA,EAAiB,iBAuBvBC,OAAOC,iBACL,UACA,IACE,MAAMC,EAAOC,EAAMD,KACnB,IAf0B,IAI1BA,GACAA,EAAKE,SAAWL,GACP,mBAATG,EAAKG,OACY,eAAhBH,EAAKI,QAA2C,cAAhBJ,EAAKI,QAQjCC,CAAsBL,GAAO,OAClC,MAAM,OAAEI,GAAWJ,EAEbM,EAAgBC,SAASC,eA7BX,gBAEA,MA6BpB,GA1BS,QAHW,EA6BCF,IAzBvB,eAAgBG,GACa,mBAAtBA,EAAOC,YACd,cAAeD,GACa,mBAArBA,EAAOE,UA6BZ,IACEL,EAAcF,KAEd,MAAMQ,EAAuC,CAC3CV,OAAQL,EACRM,KAAK,mBACLU,QAAQ,GAGVf,OAAOgB,YAAYF,EAAe,IACpC,CAAE,MAAOG,GACPC,QAAQC,MAAM,kCAAkCb,KAAWW,EAC7D,MAlBEC,QAAQE,KACN,mE","sources":["webpack://vpnn-extension/./scripts/preRollInPage.ts"],"sourcesContent":["/**\n * Этот файл компилируется в js стандарными инструментами ts\n * поэтому в нем не должно быть импортов или экспортов\n *\n * Типы и переменные указанные в этом файле должны дублировать сущности\n * указанные в src/content/scripts/preRoll/*\n */\n\ninterface YTbPlayer {\n  pauseVideo(): void;\n\n  playVideo(): void;\n}\n\nenum PreRollMessageTypes {\n  YT_METHOD_CALL = 'YT_METHOD_CALL',\n  YT_METHOD_RESULT = 'YT_METHOD_RESULT',\n}\n\ninterface YTMethodCallMessage {\n  source: string;\n  type: PreRollMessageTypes.YT_METHOD_CALL;\n  method: keyof YTbPlayer;\n}\n\ninterface YTMethodResultMessage {\n  source: string;\n  type: PreRollMessageTypes.YT_METHOD_RESULT;\n  result: any;\n}\n\nconst YT_API_WRAPPER = 'YT_API_WRAPPER';\nconst MOVIE_PLAYER_ID = 'movie_player';\n\nconst isYoutubePlayer = (\n  player: HTMLElement | null,\n): player is HTMLElement & YTbPlayer =>\n  player !== null &&\n  'pauseVideo' in player &&\n  typeof player.pauseVideo === 'function' &&\n  'playVideo' in player &&\n  typeof player.playVideo === 'function';\n\nconst isYTMethodCallMessage = (\n  data: YTMethodCallMessage,\n): data is YTMethodCallMessage => {\n  return (\n    data &&\n    data.source === YT_API_WRAPPER &&\n    data.type === PreRollMessageTypes.YT_METHOD_CALL &&\n    (data.method === 'pauseVideo' || data.method === 'playVideo')\n  );\n};\n\nwindow.addEventListener(\n  'message',\n  (event: MessageEvent<YTMethodCallMessage>) => {\n    const data = event.data;\n    if (!isYTMethodCallMessage(data)) return;\n    const { method } = data;\n\n    const playerElement = document.getElementById(MOVIE_PLAYER_ID);\n\n    if (!isYoutubePlayer(playerElement)) {\n      console.warn(\n        '[YT_API_WRAPPER] movie_player not ready or methods unavailable',\n      );\n      return;\n    }\n\n    try {\n      playerElement[method]();\n\n      const resultMessage: YTMethodResultMessage = {\n        source: YT_API_WRAPPER,\n        type: PreRollMessageTypes.YT_METHOD_RESULT,\n        result: true,\n      };\n\n      window.postMessage(resultMessage, '*');\n    } catch (err) {\n      console.error(`[YT_API_WRAPPER] Error calling ${method}:`, err);\n    }\n  },\n);\n"],"names":["YT_API_WRAPPER","window","addEventListener","data","event","source","type","method","isYTMethodCallMessage","playerElement","document","getElementById","player","pauseVideo","playVideo","resultMessage","result","postMessage","err","console","error","warn"],"sourceRoot":""}